parameters:
- name: 'TASK_NAME'
  default: 'TASK_NOT_FOUND'
  type: string
- name: 'GITHUB_AUTH'
  default: 'token'
  type: string
- name: 'GIT_COMMIT'
  default: 'sha1'
  type: string

steps:
- script: echo "##vso[task.setvariable variable=testStatus]failure"
  condition: failed()
- script: echo "##vso[task.setvariable variable=testStatus]success"
  condition: succeeded()
- task: Bash@3
    inputs:
      targetType: inline
      failOnStderr: true
      script: echo '{"state": "success", "description": "${{ parameters.TASK_NAME }}", "context": "${{ parameters.TASK_NAME }}"}'
- script: curl -X POST -H '${{ parameters.GITHUB_AUTH }}' -d data.json "https://api.github.com/repos/victor-gallet/pipelines-java/statuses/${{Â parameters.GIT_COMMIT }}"